{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import  numpy as  np\n",
    "import  pandas as  pd\n",
    "import re\n",
    "import itertools\n",
    "import copy\n",
    "from pymorphy2 import MorphAnalyzer\n",
    "from pymystem3 import Mystem\n",
    "import collections\n",
    "from collections import defaultdict\n",
    "mystem = Mystem()\n",
    "morph = MorphAnalyzer()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## the Levenshtein distance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>name</th>\n",
       "      <th>и</th>\n",
       "      <th>ы</th>\n",
       "      <th>е</th>\n",
       "      <th>э</th>\n",
       "      <th>ä</th>\n",
       "      <th>а</th>\n",
       "      <th>у</th>\n",
       "      <th>у_1</th>\n",
       "      <th>о</th>\n",
       "      <th>ъ</th>\n",
       "      <th>...</th>\n",
       "      <th>р’</th>\n",
       "      <th>j</th>\n",
       "      <th>к</th>\n",
       "      <th>к’</th>\n",
       "      <th>г</th>\n",
       "      <th>г’</th>\n",
       "      <th>х</th>\n",
       "      <th>х’</th>\n",
       "      <th>ɣ</th>\n",
       "      <th>ŋ</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>son</th>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>...</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>+</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>voc</th>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>...</td>\n",
       "      <td>+</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cons</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>...</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "      <td>+</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cor</th>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>+</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ant</th>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 54 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "name     и     ы     е     э     ä     а     у   у_1     о     ъ ... р’  j  к  \\\n",
       "son      +     +     +     +     +     +     +     +     +     + ...  +  +  -   \n",
       "voc      +     +     +     +     +     +     +     +     +     + ...  +  -  -   \n",
       "cons     -     -     -     -     -     -     -     -     -     - ...  +  +  +   \n",
       "cor   None  None  None  None  None  None  None  None  None  None ...  +  -  -   \n",
       "ant   None  None  None  None  None  None  None  None  None  None ...  -  -  -   \n",
       "\n",
       "name к’  г г’  х х’  ɣ  ŋ  \n",
       "son   -  -  -  -  -  -  +  \n",
       "voc   -  -  -  -  -  -  -  \n",
       "cons  +  +  +  +  +  +  +  \n",
       "cor   -  -  -  -  -  -  -  \n",
       "ant   -  -  -  -  -  -  -  \n",
       "\n",
       "[5 rows x 54 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pd.read_csv('fon_table.csv/data.csv')\n",
    "data = data.set_index('name')\n",
    "data = data.transpose()\n",
    "data = data.fillna('None')\n",
    "data = pd.DataFrame(data)\n",
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "data.to_csv('data.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "dist_matrix = pd.DataFrame(np.zeros((54, 54)))\n",
    "column_names = {}\n",
    "\n",
    "for i in range(0, 54):\n",
    "    column_names[i] = data.columns.tolist()[i]\n",
    "    \n",
    "dist_matrix = dist_matrix.rename(index=str, columns=column_names)\n",
    "dist_matrix['index'] = data.columns.tolist()\n",
    "dist_matrix = dist_matrix.set_index('index')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Заполняю клеточки в таблице результатами формулы\n",
    "\n",
    "1 - S_rows/ C_rows + Unc_rows*2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "comobinations = itertools.combinations_with_replacement(data.columns, 2) # - все возможные комбинации"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in comobinations:\n",
    "\n",
    "    a1 = pd.get_dummies(data[i[0]]).drop(['None'], axis=1)\n",
    "    a = a1.loc[~(a1==0).all(axis=1)]\n",
    "    b1 = pd.get_dummies(data[i[1]]).drop(['None'], axis=1)\n",
    "    b = b1.loc[~(b1==0).all(axis=1)]\n",
    "    \n",
    "    dif_a = a.index.difference(b.index)\n",
    "    similar = a.index.difference(dif_a)\n",
    "    \n",
    "    d = a.loc[similar] + b.loc[similar]\n",
    "    s_rows = 0\n",
    "    counts = d['+'].value_counts()\n",
    "\n",
    "    if 0 in counts:\n",
    "        s_rows += counts[0]\n",
    "    if 2 in counts:\n",
    "        s_rows += counts[2]\n",
    "    \n",
    "                         # common                uncommon\n",
    "    result = 1 - s_rows/(len(similar) + 2*(a.shape[0] + b.shape[0] - 2*len(similar)))\n",
    "\n",
    "    dist_matrix[i[0]][i[1]] = result\n",
    "    dist_matrix[i[1]][i[0]] = result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>и</th>\n",
       "      <th>ы</th>\n",
       "      <th>е</th>\n",
       "      <th>э</th>\n",
       "      <th>ä</th>\n",
       "      <th>а</th>\n",
       "      <th>у</th>\n",
       "      <th>у_1</th>\n",
       "      <th>о</th>\n",
       "      <th>ъ</th>\n",
       "      <th>...</th>\n",
       "      <th>р’</th>\n",
       "      <th>j</th>\n",
       "      <th>к</th>\n",
       "      <th>к’</th>\n",
       "      <th>г</th>\n",
       "      <th>г’</th>\n",
       "      <th>х</th>\n",
       "      <th>х’</th>\n",
       "      <th>ɣ</th>\n",
       "      <th>ŋ</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>index</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>и</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ы</th>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>е</th>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>э</th>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ä</th>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>а</th>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>у</th>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>у_1</th>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>о</th>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ъ</th>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ь</th>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ṷ</th>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>...</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.111111</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.545455</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ў</th>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>0.863636</td>\n",
       "      <td>...</td>\n",
       "      <td>0.727273</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.545455</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>п</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>п’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>б</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>б’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ф</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.769231</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.615385</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ф’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>в</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.785714</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.714286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>в’</th>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.960000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.714286</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.785714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>м</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.100000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>м’</th>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>т</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>т’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>д</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>д’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>с</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>с’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.769231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>з</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>з’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.769231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>н</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>...</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.636364</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.769231</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>н’</th>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.769231</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.769231</td>\n",
       "      <td>0.300000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>л</th>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.700000</td>\n",
       "      <td>0.785714</td>\n",
       "      <td>0.857143</td>\n",
       "      <td>0.785714</td>\n",
       "      <td>0.857143</td>\n",
       "      <td>0.750000</td>\n",
       "      <td>0.833333</td>\n",
       "      <td>0.750000</td>\n",
       "      <td>0.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>л’</th>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.850000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>0.900000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.857143</td>\n",
       "      <td>0.785714</td>\n",
       "      <td>0.857143</td>\n",
       "      <td>0.785714</td>\n",
       "      <td>0.833333</td>\n",
       "      <td>0.750000</td>\n",
       "      <td>0.833333</td>\n",
       "      <td>0.833333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ц</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>дз</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ш</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.615385</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ш’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ж</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.615385</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ж’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ч’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>дж’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.583333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>р</th>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.545455</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.300000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>р’</th>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.875000</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.400000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>j</th>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.909091</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>0.954545</td>\n",
       "      <td>...</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.454545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>к</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>к’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.416667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>г</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>г’</th>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.961538</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.090909</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>х</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.538462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>х’</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.272727</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.615385</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ɣ</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>...</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.363636</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.538462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ŋ</th>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.958333</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>0.916667</td>\n",
       "      <td>...</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.454545</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.615385</td>\n",
       "      <td>0.538462</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>54 rows × 54 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              и         ы         е         э         ä         а         у  \\\n",
       "index                                                                         \n",
       "и      0.000000  0.125000  0.125000  0.250000  0.250000  0.375000  0.250000   \n",
       "ы      0.125000  0.000000  0.250000  0.125000  0.375000  0.250000  0.125000   \n",
       "е      0.125000  0.250000  0.000000  0.125000  0.125000  0.250000  0.375000   \n",
       "э      0.250000  0.125000  0.125000  0.000000  0.250000  0.125000  0.250000   \n",
       "ä      0.250000  0.375000  0.125000  0.250000  0.000000  0.125000  0.500000   \n",
       "а      0.375000  0.250000  0.250000  0.125000  0.125000  0.000000  0.375000   \n",
       "у      0.250000  0.125000  0.375000  0.250000  0.500000  0.375000  0.000000   \n",
       "у_1    0.125000  0.250000  0.250000  0.375000  0.375000  0.500000  0.125000   \n",
       "о      0.375000  0.250000  0.250000  0.125000  0.375000  0.250000  0.125000   \n",
       "ъ      0.375000  0.250000  0.250000  0.125000  0.375000  0.250000  0.375000   \n",
       "ь      0.250000  0.375000  0.125000  0.250000  0.250000  0.375000  0.500000   \n",
       "ṷ      0.863636  0.909091  0.863636  0.909091  0.863636  0.909091  0.909091   \n",
       "ў      0.909091  0.863636  0.909091  0.863636  0.909091  0.863636  0.863636   \n",
       "п      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "п’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "б      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "б’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "ф      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "ф’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "в      1.000000  0.960000  1.000000  0.960000  1.000000  0.960000  0.960000   \n",
       "в’     0.960000  1.000000  0.960000  1.000000  0.960000  1.000000  1.000000   \n",
       "м      0.958333  0.916667  0.958333  0.916667  0.958333  0.916667  0.916667   \n",
       "м’     0.916667  0.958333  0.916667  0.958333  0.916667  0.958333  0.958333   \n",
       "т      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "т’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "д      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "д’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "с      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "с’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "з      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "з’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "н      0.958333  0.916667  0.958333  0.916667  0.958333  0.916667  0.916667   \n",
       "н’     0.916667  0.958333  0.916667  0.958333  0.916667  0.958333  0.958333   \n",
       "л      0.900000  0.850000  0.900000  0.850000  0.900000  0.850000  0.850000   \n",
       "л’     0.850000  0.900000  0.850000  0.900000  0.850000  0.900000  0.900000   \n",
       "ц      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "дз     1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "ш      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "ш’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "ж      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "ж’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "ч’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "дж’    0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "р      0.916667  0.875000  0.916667  0.875000  0.916667  0.875000  0.875000   \n",
       "р’     0.875000  0.916667  0.875000  0.916667  0.875000  0.916667  0.916667   \n",
       "j      0.909091  0.954545  0.909091  0.954545  0.909091  0.954545  0.954545   \n",
       "к      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "к’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "г      1.000000  0.961538  1.000000  0.961538  1.000000  0.961538  0.961538   \n",
       "г’     0.961538  1.000000  0.961538  1.000000  0.961538  1.000000  1.000000   \n",
       "х      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "х’     0.958333  1.000000  0.958333  1.000000  0.958333  1.000000  1.000000   \n",
       "ɣ      1.000000  0.958333  1.000000  0.958333  1.000000  0.958333  0.958333   \n",
       "ŋ      0.958333  0.916667  0.958333  0.916667  0.958333  0.916667  0.916667   \n",
       "\n",
       "            у_1         о         ъ    ...           р’         j         к  \\\n",
       "index                                  ...                                    \n",
       "и      0.125000  0.375000  0.375000    ...     0.875000  0.909091  1.000000   \n",
       "ы      0.250000  0.250000  0.250000    ...     0.916667  0.954545  0.961538   \n",
       "е      0.250000  0.250000  0.250000    ...     0.875000  0.909091  1.000000   \n",
       "э      0.375000  0.125000  0.125000    ...     0.916667  0.954545  0.961538   \n",
       "ä      0.375000  0.375000  0.375000    ...     0.875000  0.909091  1.000000   \n",
       "а      0.500000  0.250000  0.250000    ...     0.916667  0.954545  0.961538   \n",
       "у      0.125000  0.125000  0.375000    ...     0.916667  0.954545  0.961538   \n",
       "у_1    0.000000  0.250000  0.500000    ...     0.875000  0.909091  1.000000   \n",
       "о      0.250000  0.000000  0.250000    ...     0.916667  0.954545  0.961538   \n",
       "ъ      0.500000  0.250000  0.000000    ...     0.916667  0.954545  0.961538   \n",
       "ь      0.375000  0.375000  0.125000    ...     0.875000  0.909091  1.000000   \n",
       "ṷ      0.863636  0.909091  0.909091    ...     0.545455  0.111111  0.615385   \n",
       "ў      0.909091  0.863636  0.863636    ...     0.727273  0.333333  0.615385   \n",
       "п      1.000000  0.961538  0.961538    ...     0.583333  0.615385  0.090909   \n",
       "п’     0.961538  1.000000  1.000000    ...     0.500000  0.538462  0.181818   \n",
       "б      1.000000  0.961538  0.961538    ...     0.583333  0.615385  0.181818   \n",
       "б’     0.961538  1.000000  1.000000    ...     0.500000  0.538462  0.272727   \n",
       "ф      1.000000  0.958333  0.958333    ...     0.769231  0.454545  0.333333   \n",
       "ф’     0.958333  1.000000  1.000000    ...     0.692308  0.363636  0.416667   \n",
       "в      1.000000  0.960000  0.960000    ...     0.785714  0.583333  0.538462   \n",
       "в’     0.960000  1.000000  1.000000    ...     0.714286  0.500000  0.615385   \n",
       "м      0.958333  0.916667  0.916667    ...     0.500000  0.545455  0.416667   \n",
       "м’     0.916667  0.958333  0.958333    ...     0.400000  0.454545  0.500000   \n",
       "т      1.000000  0.961538  0.961538    ...     0.500000  0.692308  0.181818   \n",
       "т’     0.961538  1.000000  1.000000    ...     0.416667  0.615385  0.272727   \n",
       "д      1.000000  0.961538  0.961538    ...     0.500000  0.692308  0.272727   \n",
       "д’     0.961538  1.000000  1.000000    ...     0.416667  0.615385  0.363636   \n",
       "с      1.000000  0.958333  0.958333    ...     0.692308  0.545455  0.416667   \n",
       "с’     0.958333  1.000000  1.000000    ...     0.615385  0.454545  0.500000   \n",
       "з      1.000000  0.958333  0.958333    ...     0.692308  0.545455  0.500000   \n",
       "з’     0.958333  1.000000  1.000000    ...     0.615385  0.454545  0.583333   \n",
       "н      0.958333  0.916667  0.916667    ...     0.400000  0.636364  0.500000   \n",
       "н’     0.916667  0.958333  0.958333    ...     0.300000  0.545455  0.583333   \n",
       "л      0.900000  0.850000  0.850000    ...     0.583333  0.700000  0.785714   \n",
       "л’     0.850000  0.900000  0.900000    ...     0.500000  0.600000  0.857143   \n",
       "ц      1.000000  0.961538  0.961538    ...     0.583333  0.692308  0.272727   \n",
       "дз     1.000000  0.961538  0.961538    ...     0.583333  0.692308  0.363636   \n",
       "ш      1.000000  0.958333  0.958333    ...     0.615385  0.454545  0.333333   \n",
       "ш’     0.958333  1.000000  1.000000    ...     0.538462  0.363636  0.416667   \n",
       "ж      1.000000  0.958333  0.958333    ...     0.615385  0.454545  0.416667   \n",
       "ж’     0.958333  1.000000  1.000000    ...     0.538462  0.363636  0.500000   \n",
       "ч’     0.961538  1.000000  1.000000    ...     0.416667  0.538462  0.272727   \n",
       "дж’    0.961538  1.000000  1.000000    ...     0.416667  0.538462  0.363636   \n",
       "р      0.916667  0.875000  0.875000    ...     0.100000  0.545455  0.416667   \n",
       "р’     0.875000  0.916667  0.916667    ...     0.000000  0.454545  0.500000   \n",
       "j      0.909091  0.954545  0.954545    ...     0.454545  0.000000  0.538462   \n",
       "к      1.000000  0.961538  0.961538    ...     0.500000  0.538462  0.000000   \n",
       "к’     0.961538  1.000000  1.000000    ...     0.416667  0.461538  0.090909   \n",
       "г      1.000000  0.961538  0.961538    ...     0.500000  0.538462  0.090909   \n",
       "г’     0.961538  1.000000  1.000000    ...     0.416667  0.461538  0.181818   \n",
       "х      1.000000  0.958333  0.958333    ...     0.692308  0.363636  0.250000   \n",
       "х’     0.958333  1.000000  1.000000    ...     0.615385  0.272727  0.333333   \n",
       "ɣ      1.000000  0.958333  0.958333    ...     0.692308  0.363636  0.333333   \n",
       "ŋ      0.958333  0.916667  0.916667    ...     0.400000  0.454545  0.333333   \n",
       "\n",
       "             к’         г        г’         х        х’         ɣ         ŋ  \n",
       "index                                                                        \n",
       "и      0.961538  1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  \n",
       "ы      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "е      0.961538  1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  \n",
       "э      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "ä      0.961538  1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  \n",
       "а      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "у      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "у_1    0.961538  1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  \n",
       "о      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "ъ      1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  0.916667  \n",
       "ь      0.961538  1.000000  0.961538  1.000000  0.958333  1.000000  0.958333  \n",
       "ṷ      0.538462  0.615385  0.538462  0.454545  0.363636  0.454545  0.545455  \n",
       "ў      0.692308  0.615385  0.692308  0.454545  0.545455  0.454545  0.545455  \n",
       "п      0.181818  0.181818  0.272727  0.333333  0.416667  0.416667  0.416667  \n",
       "п’     0.090909  0.272727  0.181818  0.416667  0.333333  0.500000  0.500000  \n",
       "б      0.272727  0.090909  0.181818  0.416667  0.500000  0.333333  0.416667  \n",
       "б’     0.181818  0.181818  0.090909  0.500000  0.416667  0.416667  0.500000  \n",
       "ф      0.416667  0.416667  0.500000  0.100000  0.200000  0.200000  0.615385  \n",
       "ф’     0.333333  0.500000  0.416667  0.200000  0.100000  0.300000  0.692308  \n",
       "в      0.615385  0.461538  0.538462  0.363636  0.454545  0.272727  0.714286  \n",
       "в’     0.538462  0.538462  0.461538  0.454545  0.363636  0.363636  0.785714  \n",
       "м      0.500000  0.416667  0.500000  0.615385  0.692308  0.615385  0.100000  \n",
       "м’     0.416667  0.500000  0.416667  0.692308  0.615385  0.692308  0.200000  \n",
       "т      0.272727  0.272727  0.363636  0.416667  0.500000  0.500000  0.500000  \n",
       "т’     0.181818  0.363636  0.272727  0.500000  0.416667  0.583333  0.583333  \n",
       "д      0.363636  0.181818  0.272727  0.500000  0.583333  0.416667  0.500000  \n",
       "д’     0.272727  0.272727  0.181818  0.583333  0.500000  0.500000  0.583333  \n",
       "с      0.500000  0.500000  0.583333  0.200000  0.300000  0.300000  0.692308  \n",
       "с’     0.416667  0.583333  0.500000  0.300000  0.200000  0.400000  0.769231  \n",
       "з      0.583333  0.416667  0.500000  0.300000  0.400000  0.200000  0.692308  \n",
       "з’     0.500000  0.500000  0.416667  0.400000  0.300000  0.300000  0.769231  \n",
       "н      0.583333  0.500000  0.583333  0.692308  0.769231  0.692308  0.200000  \n",
       "н’     0.500000  0.583333  0.500000  0.769231  0.692308  0.769231  0.300000  \n",
       "л      0.857143  0.785714  0.857143  0.750000  0.833333  0.750000  0.750000  \n",
       "л’     0.785714  0.857143  0.785714  0.833333  0.750000  0.833333  0.833333  \n",
       "ц      0.363636  0.363636  0.454545  0.416667  0.500000  0.500000  0.583333  \n",
       "дз     0.454545  0.272727  0.363636  0.500000  0.583333  0.416667  0.583333  \n",
       "ш      0.416667  0.416667  0.500000  0.100000  0.200000  0.200000  0.615385  \n",
       "ш’     0.333333  0.500000  0.416667  0.200000  0.100000  0.300000  0.692308  \n",
       "ж      0.500000  0.333333  0.416667  0.200000  0.300000  0.100000  0.615385  \n",
       "ж’     0.416667  0.416667  0.333333  0.300000  0.200000  0.200000  0.692308  \n",
       "ч’     0.181818  0.363636  0.272727  0.416667  0.333333  0.500000  0.583333  \n",
       "дж’    0.272727  0.272727  0.181818  0.500000  0.416667  0.416667  0.583333  \n",
       "р      0.500000  0.416667  0.500000  0.615385  0.692308  0.615385  0.300000  \n",
       "р’     0.416667  0.500000  0.416667  0.692308  0.615385  0.692308  0.400000  \n",
       "j      0.461538  0.538462  0.461538  0.363636  0.272727  0.363636  0.454545  \n",
       "к      0.090909  0.090909  0.181818  0.250000  0.333333  0.333333  0.333333  \n",
       "к’     0.000000  0.181818  0.090909  0.333333  0.250000  0.416667  0.416667  \n",
       "г      0.181818  0.000000  0.090909  0.333333  0.416667  0.250000  0.333333  \n",
       "г’     0.090909  0.090909  0.000000  0.416667  0.333333  0.333333  0.416667  \n",
       "х      0.333333  0.333333  0.416667  0.000000  0.100000  0.100000  0.538462  \n",
       "х’     0.250000  0.416667  0.333333  0.100000  0.000000  0.200000  0.615385  \n",
       "ɣ      0.416667  0.250000  0.333333  0.100000  0.200000  0.000000  0.538462  \n",
       "ŋ      0.416667  0.333333  0.416667  0.538462  0.615385  0.538462  0.000000  \n",
       "\n",
       "[54 rows x 54 columns]"
      ]
     },
     "execution_count": 162,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dist_matrix#.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "dist_matrix.to_csv('distance_matrix.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "f = open('ru_st_normalized.csv', 'a', encoding='utf-8')\n",
    "for index, row in st_words.iterrows():\n",
    "    f.write(str(index) + ';' + str(row['stressed_s']) + '\\n')\n",
    "f.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "f = open('distance_matrix.csv', 'w', encoding='uft-8')\n",
    "for index, row in dist_matrix.iterrows():\n",
    "    f.write(str(index) + ';' + str(row['stressed_s']) + '\\n')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Расстояние Левенштейна"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "def lev_distance(a, b):\n",
    "    \n",
    "    # Первыми - строчки \n",
    "    # столбики - слово b\n",
    "    \n",
    "    dis = np.zeros((len(a) + 1, len(b) + 1))\n",
    "    i = 0\n",
    "    row = 0\n",
    "    col = 0\n",
    "\n",
    "    while i < dis.size:\n",
    "\n",
    "        if row == 0:\n",
    "            if col != 0:\n",
    "                dis[row, col] = dis[row, col-1] + 1\n",
    "\n",
    "        elif col == 0:\n",
    "            if row != 0:\n",
    "                dis[row, col] = dis[row - 1, col] + 1\n",
    "        \n",
    "  \n",
    "        elif row > 1 and col > 1 and a[row-1] == b[col-2] and a[row-2] == b[col-1]:\n",
    "            dis[row, col] = dis[row - 3][col - 3] + 1\n",
    "            \n",
    "        \n",
    "        else:\n",
    "            dis[row, col] = np.min([dis[row, col - 1] + 1,  # левый \n",
    "                                    dis[row - 1, col - 1] + dist_matrix[a[row-1]][b[col-1]], # диаг               \n",
    "                                    dis[row - 1, col] + 1]) # верхний\n",
    "        \n",
    "        col += 1\n",
    "        i += 1  \n",
    "        if col == len(b) + 1:\n",
    "            col = 0\n",
    "            row += 1\n",
    "  \n",
    "    return dis[len(a), len(b)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Фонетические изменения"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ГЛАСНЫЕ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>#</th>\n",
       "      <th>v2_hard</th>\n",
       "      <th>v2_soft</th>\n",
       "      <th>v1_hard</th>\n",
       "      <th>v1_sh</th>\n",
       "      <th>v1_soft</th>\n",
       "      <th>V</th>\n",
       "      <th>vn_hard</th>\n",
       "      <th>vn_soft</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>а</th>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>а</td>\n",
       "      <td>a</td>\n",
       "      <td>и</td>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>я</th>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>а</td>\n",
       "      <td>a</td>\n",
       "      <td>и</td>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>о</th>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>а</td>\n",
       "      <td>ы</td>\n",
       "      <td>и</td>\n",
       "      <td>о</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ё</th>\n",
       "      <td>а</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>а</td>\n",
       "      <td>ы</td>\n",
       "      <td>и</td>\n",
       "      <td>о</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>у</th>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ю</th>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "      <td>у</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>е</th>\n",
       "      <td>и</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>ы</td>\n",
       "      <td>ы</td>\n",
       "      <td>и</td>\n",
       "      <td>е</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>э</th>\n",
       "      <td>и</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>ы</td>\n",
       "      <td>ы</td>\n",
       "      <td></td>\n",
       "      <td>э</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>и</th>\n",
       "      <td>и</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "      <td>ы</td>\n",
       "      <td>ы</td>\n",
       "      <td>и</td>\n",
       "      <td>и</td>\n",
       "      <td>ъ</td>\n",
       "      <td>ь</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ы</th>\n",
       "      <td>и</td>\n",
       "      <td>ъ</td>\n",
       "      <td></td>\n",
       "      <td>ы</td>\n",
       "      <td>ы</td>\n",
       "      <td></td>\n",
       "      <td>ы</td>\n",
       "      <td>ъ</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      # v2_hard v2_soft v1_hard v1_sh v1_soft  V vn_hard vn_soft\n",
       "name                                                            \n",
       "а     а       ъ       ь       а     a       и  а       ъ       ь\n",
       "я     а       ъ       ь       а     a       и  а       ъ       ь\n",
       "о     а       ъ       ь       а     ы       и  о       ъ       ь\n",
       "ё     а       ъ       ь       а     ы       и  о       ъ       ь\n",
       "у     у       у       у       у     у       у  у       у       у\n",
       "ю     у       у       у       у     у       у  у       у       у\n",
       "е     и       ъ       ь       ы     ы       и  е       ъ       ь\n",
       "э     и       ъ       ь       ы     ы          э       ъ       ь\n",
       "и     и       ъ       ь       ы     ы       и  и       ъ       ь\n",
       "ы     и       ъ               ы     ы          ы       ъ        "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vows = pd.read_csv('vowels.csv', sep=';')\n",
    "vows = vows.set_index('Unnamed: 0')\n",
    "vows = vows.reindex(vows.index.rename('name'))\n",
    "vows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "vows.to_csv('vows.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "СОГЛАСНЫЕ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>soft</th>\n",
       "      <th>hard</th>\n",
       "      <th>voiced</th>\n",
       "      <th>no_voice</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>б</th>\n",
       "      <td>б’</td>\n",
       "      <td>б</td>\n",
       "      <td>б</td>\n",
       "      <td>п</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>в</th>\n",
       "      <td>в’</td>\n",
       "      <td>в</td>\n",
       "      <td>в</td>\n",
       "      <td>ф</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>г</th>\n",
       "      <td>г’</td>\n",
       "      <td>г</td>\n",
       "      <td>г</td>\n",
       "      <td>к</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>д</th>\n",
       "      <td>д’</td>\n",
       "      <td>д</td>\n",
       "      <td>д</td>\n",
       "      <td>т</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ж</th>\n",
       "      <td>ж</td>\n",
       "      <td>ж</td>\n",
       "      <td>ж</td>\n",
       "      <td>ш</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>з</th>\n",
       "      <td>з’</td>\n",
       "      <td>з</td>\n",
       "      <td>з</td>\n",
       "      <td>с</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>й</th>\n",
       "      <td>j</td>\n",
       "      <td>j</td>\n",
       "      <td>j</td>\n",
       "      <td>j</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>к</th>\n",
       "      <td>к’</td>\n",
       "      <td>к</td>\n",
       "      <td>г</td>\n",
       "      <td>к</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>л</th>\n",
       "      <td>л’</td>\n",
       "      <td>л</td>\n",
       "      <td>л</td>\n",
       "      <td>л</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>м</th>\n",
       "      <td>м’</td>\n",
       "      <td>м</td>\n",
       "      <td>м</td>\n",
       "      <td>м</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>н</th>\n",
       "      <td>н’</td>\n",
       "      <td>н</td>\n",
       "      <td>н</td>\n",
       "      <td>н</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>п</th>\n",
       "      <td>п’</td>\n",
       "      <td>п</td>\n",
       "      <td>б</td>\n",
       "      <td>п</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>р</th>\n",
       "      <td>р’</td>\n",
       "      <td>р</td>\n",
       "      <td>р</td>\n",
       "      <td>р</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>с</th>\n",
       "      <td>с’</td>\n",
       "      <td>с</td>\n",
       "      <td>з</td>\n",
       "      <td>с</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>т</th>\n",
       "      <td>т’</td>\n",
       "      <td>т</td>\n",
       "      <td>д</td>\n",
       "      <td>т</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ф</th>\n",
       "      <td>ф’</td>\n",
       "      <td>ф</td>\n",
       "      <td>в</td>\n",
       "      <td>ф</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>х</th>\n",
       "      <td>х’</td>\n",
       "      <td>х</td>\n",
       "      <td>х</td>\n",
       "      <td>х</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ц</th>\n",
       "      <td>ц</td>\n",
       "      <td>ц</td>\n",
       "      <td>ц</td>\n",
       "      <td>ц</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ч</th>\n",
       "      <td>ч’</td>\n",
       "      <td>ч’</td>\n",
       "      <td>ч’</td>\n",
       "      <td>ч’</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ш</th>\n",
       "      <td>ш</td>\n",
       "      <td>ш</td>\n",
       "      <td>ж</td>\n",
       "      <td>ш</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>щ</th>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     soft hard voiced no_voice\n",
       "name                          \n",
       "б      б’    б      б        п\n",
       "в      в’    в      в        ф\n",
       "г      г’    г      г        к\n",
       "д      д’    д      д        т\n",
       "ж       ж    ж      ж        ш\n",
       "з      з’    з      з        с\n",
       "й       j    j      j        j\n",
       "к      к’    к      г        к\n",
       "л      л’    л      л        л\n",
       "м      м’    м      м        м\n",
       "н      н’    н      н        н\n",
       "п      п’    п      б        п\n",
       "р      р’    р      р        р\n",
       "с      с’    с      з        с\n",
       "т      т’    т      д        т\n",
       "ф      ф’    ф      в        ф\n",
       "х      х’    х      х        х\n",
       "ц       ц    ц      ц        ц\n",
       "ч      ч’   ч’     ч’       ч’\n",
       "ш       ш    ш      ж        ш\n",
       "щ      ш’   ш’     ш’       ш’"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cons = pd.read_csv('cons.csv', sep=';')\n",
    "cons = cons.set_index('Unnamed: 0')\n",
    "cons = cons.reindex(cons.index.rename('name'))\n",
    "cons"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "cons.to_csv('cons_.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Таблица, которая помогает учесть ассимиляцию"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>с</th>\n",
       "      <th>ш</th>\n",
       "      <th>щ</th>\n",
       "      <th>ч</th>\n",
       "      <th>ж</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>с</th>\n",
       "      <td>-</td>\n",
       "      <td>ш</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ж</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>сс</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ш’</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ст</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ш’</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>з</th>\n",
       "      <td>-</td>\n",
       "      <td>ш</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ж’</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>зд</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ш’</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>т</th>\n",
       "      <td>ц</td>\n",
       "      <td>ч’</td>\n",
       "      <td>-</td>\n",
       "      <td>ч’</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ть</th>\n",
       "      <td>ц</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>д</th>\n",
       "      <td>ц</td>\n",
       "      <td>ч’</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ж</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ш’</td>\n",
       "      <td>ж’</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ш</th>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ш’</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      с   ш   щ   ч   ж\n",
       "name                   \n",
       "с     -   ш  ш’  ш’   ж\n",
       "сс    -   -   -  ш’   -\n",
       "ст    -   -   -  ш’   -\n",
       "з     -   ш  ш’  ш’  ж’\n",
       "зд    -   -  ш’  ш’   -\n",
       "т     ц  ч’   -  ч’   -\n",
       "ть    ц   -   -   -   -\n",
       "д     ц  ч’   -   -   -\n",
       "ж     -   -   -  ш’  ж’\n",
       "ш     -   -   -  ш’   -"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "aff = pd.read_csv('aff.csv', sep=';')\n",
    "aff = aff.set_index('Unnamed: 0')\n",
    "aff = aff.reindex(aff.index.rename('name'))\n",
    "aff"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "aff.to_csv('aff_.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ТАБЛИЦА УДАРЕНИЙ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>stressed_s</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>word</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>а</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>аа</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ааа</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>аааа</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ааааа</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       stressed_s\n",
       "word             \n",
       "а               1\n",
       "аа              2\n",
       "ааа             3\n",
       "аааа            4\n",
       "ааааа           5"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "st_words = pd.read_csv('ru_reversed.csv', sep='\\t')\n",
    "new = st_words['word'].str.replace(r'[^\\w\\s]', '')\n",
    "new = new.str.lower()\n",
    "st_words['word'] =  new\n",
    "st_words = st_words.drop_duplicates()\n",
    "st_words = st_words.set_index('word')\n",
    "st_words.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "st_words.to_csv('stress_data.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ТРАНСКРИПЦИЯ"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Кол-во гласных в слова"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "def num_of_vowls(word):\n",
    "    \n",
    "    num = len(re.findall('(а|е|ё|о|и|я|ю|у|ы|э)', word))   \n",
    "\n",
    "    if num:\n",
    "        return num  \n",
    "    else:\n",
    "        return 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_of_vowls('мама')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_of_vowls('vfa')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Функция, которая ищет заданное слово в словаре с ударениями. Возращает номер гласной, на которой стоит ударение. Чтобы не использовать дополнительную память, сделала из него генератор. Если слова в словаре нет, то предлагаются все возможные варинты"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "def stressed(word, st_words):\n",
    "    \n",
    "    try:\n",
    "        a = st_words.loc[word]['stressed_s'].tolist()\n",
    "   \n",
    "        if isinstance(a, list):\n",
    "            yield from a\n",
    "        else:\n",
    "            yield from [a]\n",
    "    \n",
    "    except KeyError:\n",
    "        yield from range(1, num_of_vowls(word) + 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[2, 1]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[i for i in stressed('замок', st_words)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2\n",
      "1\n"
     ]
    }
   ],
   "source": [
    "for i in stressed('замок', st_words):\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Изменения гласных"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 579,
   "metadata": {},
   "outputs": [],
   "source": [
    "def j2(letter, index, length, vows, next_, position, j_):\n",
    "\n",
    "    ans = vows.loc[letter][position]\n",
    "\n",
    "    if letter in ('ю', 'е', 'ё', 'я'):\n",
    "        \n",
    "        if index == length - 1:\n",
    "            j_ = True\n",
    "\n",
    "        elif next_ in vows.index:\n",
    "            j_ = True\n",
    "            if 'vn' in position:\n",
    "                ans = vows.loc[letter]['vn_hard']\n",
    "\n",
    "        elif next_ in ('ь', 'ъ'):\n",
    "            j_ = True\n",
    "            if 'vn' in position:\n",
    "                ans = vows.loc[letter]['vn_hard']\n",
    "\n",
    "    elif letter in ('и', 'о') and next_ == 'ь':\n",
    "        j_ = True\n",
    "        if 'vn' in position:\n",
    "                ans = vows.loc[letter]['vn_hard']\n",
    "    \n",
    "    return ans, j_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 544,
   "metadata": {},
   "outputs": [],
   "source": [
    "def vows_after_aff(ans2, index, answer):\n",
    "    \n",
    "    if data[ans2]['back'] == '+' and index > 0:\n",
    "        if answer[-1] == 'е':\n",
    "            answer[-1] = 'э'\n",
    "        if answer[-1] == 'и':\n",
    "            answer[-1] = 'ы'\n",
    "        if answer[-1] == 'ь':\n",
    "            answer[-1] = 'ъ'\n",
    "\n",
    "    elif data[ans2]['back'] == '-' and index > 0:\n",
    "        if answer[-1] == 'э':\n",
    "            answer[-1] = 'е'\n",
    "        if answer[-1] == 'ы':\n",
    "            answer[-1] = 'и'\n",
    "        if answer[-1] == 'ъ':\n",
    "            answer[-1] = 'ь'\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 581,
   "metadata": {},
   "outputs": [],
   "source": [
    "def cons_tranformer2(letter, no_voice, soft, voice, index, length, letters, gap, answer, vcd=False):\n",
    "\n",
    "    if gap > 0:  # пропуск в случае ассимиляции\n",
    "        gap -= 1\n",
    "        return '', no_voice, soft, voice, gap\n",
    "    \n",
    "    if index + 1 <= length-1:\n",
    "        next_ = letters[index+1]\n",
    "    else:\n",
    "        next_ = ''\n",
    "\n",
    "    if letter in ('ч', 'ш', 'щ', 'ж'):\n",
    "        ans = cons.loc[letter]['hard']\n",
    "        soft = False\n",
    "        if letter in ('ч', 'щ'):\n",
    "            no_voice = False\n",
    "            voice = False\n",
    "    else:\n",
    "        ans = letter\n",
    "\n",
    "    if no_voice and ans:  # оглушение\n",
    "        ans = cons.loc[ans]['no_voice']\n",
    "\n",
    "    elif voice:  # озвончение\n",
    "        ans = cons.loc[ans]['voiced']\n",
    "\n",
    "    if vcd is True:\n",
    "        if index == 0 or index-1 == 0 and next_ in ('ь', 'ъ'):\n",
    "            ans = cons.loc[ans]['voiced']\n",
    "\n",
    "    if not vcd:\n",
    "        if index == 0 or index-1 == 0 and next_ in ('ь', 'ъ'):  # конец слова\n",
    "            no_voice = True\n",
    "            if data[ans]['vcd'] == '+':\n",
    "                ans = cons.loc[ans]['no_voice']\n",
    "\n",
    "    if ans in data.columns and data[ans]['son'] == '-' and ans not in ('в', \"в’\") and data[ans]['vcd'] == '+':  # озвончение слудующих\n",
    "        voice = True\n",
    "    \n",
    "    elif ans in data.columns and data[ans]['vcd'] == '-' and index + 1 <= length-1:  # оглушение следующих\n",
    "\n",
    "        if next_ not in ('ь', 'ъ') and next_ in data.columns and data[next_]['son'] == '-':\n",
    "            no_voice = True\n",
    "    \n",
    "        elif index + 2 <= length-1 and letters[index+2] in data.columns and data[letters[index+2]]['son'] == '-':\n",
    "            no_voice = True\n",
    "\n",
    "    if index-1 >= 0:\n",
    "\n",
    "        if len(answer) > index-1 and answer[index-1] == 'к' and letter == 'г':\n",
    "            ans = 'х'\n",
    "        \n",
    "        elif len(answer) > index-1 and answer[index-1] == 'т' and ans == \"ч’\":\n",
    "            ans = 'ш'\n",
    "\n",
    "        elif len(answer) > index-1 and answer[index-1] in (ans, ans + \"’\"):\n",
    "            return '', no_voice, soft, voice, gap\n",
    "\n",
    "    if soft:  # смягчение\n",
    "        ans = cons.loc[ans]['soft']\n",
    "\n",
    "    soft = False\n",
    "    return ans, no_voice, soft, voice, gap"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 582,
   "metadata": {},
   "outputs": [],
   "source": [
    "def transcription2(word, stress=False, next_word=False, separate=True, stop=False, vcd=False):\n",
    "    \n",
    "    \"\"\"\n",
    "    Фунция, которая определяет фонетическую транскриацию для слова с заданным ударением,\n",
    "    расчитываемым с конца слова. \n",
    "    \n",
    "    Функция принимает 3 аргемента: \n",
    "    i - type int, номер гласного, на который падает ударение (отсчет производится с конца слова).\n",
    "    word - type str, слово, для которого должен произвожится разбор. \n",
    "    \n",
    "    >>> transcription(2, 'мама')\n",
    "    ['м', 'а', 'м', 'ъ']\n",
    "    \n",
    "    >>> transcription(1, 'мама')\n",
    "    ['м', 'а', 'м', 'а']\n",
    "    \n",
    "    \n",
    "    Функция работает только с кириллическими символами. Если в слове содержатся не кириллические символы, вызывается ошибка.\n",
    "    \n",
    "    >>> transcription(2, 'papa')\n",
    "    Traceback (most recent call last):\n",
    "        ...\n",
    "    ValueError: No vowles or not Cyrillic elements\n",
    "    \n",
    "    \n",
    "    Если пользователь указывает номер гласной меньший кол-ва гласных, вызывается ошибка.\n",
    "    \n",
    "    >>> transcription(3, 'мама')\n",
    "    Traceback (most recent call last):\n",
    "        ...\n",
    "    ValueError: There are only 2 vowel(s)\n",
    "    \"\"\"\n",
    "    \n",
    "    if not isinstance(word, str):\n",
    "        raise ValueError('Wrong data type')\n",
    "        \n",
    "    if not isinstance(stress, int):\n",
    "        raise ValueError('Wrong data type')\n",
    "        \n",
    "    if ' ' in word:\n",
    "        raise ValueError('Enter a word, not a phrase')\n",
    "        \n",
    "    nums = num_of_vowls(word)\n",
    "\n",
    "    if stress:\n",
    "        if nums < stress or stress <= 0:\n",
    "            raise ValueError('There are only {} vowel(s)'.format(str(num_of_vowls(word))))\n",
    "        \n",
    "    if not stress:\n",
    "        stress = nums//2 + 1\n",
    "    \n",
    "    if stop == True:\n",
    "        stress = -100000\n",
    "\n",
    "    letters = list(change(word))[::-1]\n",
    "    answer = []\n",
    "    length = len(letters)\n",
    "    vow_n = 0\n",
    "    soft = False\n",
    "    voice = False\n",
    "    no_voice = False\n",
    "    gap = False\n",
    "    j_ = False\n",
    "    special = False\n",
    "        \n",
    "    for index, letter in enumerate(letters):\n",
    "\n",
    "        letter = letter.lower()\n",
    "  \n",
    "        if letter in vows.index:\n",
    "        \n",
    "            voice = False\n",
    "            no_voice = False\n",
    "            gap = 0\n",
    "            soft = False\n",
    "            vow_n += 1\n",
    "        \n",
    "            ans, soft, j_ = due_to_vow_table2(vow_n, stress, letter, index, length, letters, soft, j_)\n",
    "            \n",
    "            if j_ is True and index == 0 and vow_n != stress:\n",
    "                special = True\n",
    "    \n",
    "        elif letter == 'ь' or letter == 'ъ': \n",
    "\n",
    "            if letter == 'ь':\n",
    "                soft = True\n",
    "                \n",
    "            if letter == 'ъ':\n",
    "                soft = False\n",
    "            continue\n",
    "    \n",
    "        elif letter in cons.index:\n",
    "        \n",
    "            if letter == 'й':\n",
    "                ans = 'ṷ'\n",
    "            \n",
    "            else:\n",
    "                ans, no_voice, soft, voice, gap = cons_tranformer2(letter, no_voice, soft, voice, index, length, letters, gap, answer, vcd=vcd)\n",
    "        \n",
    "                if ans == '':\n",
    "                    continue\n",
    "        else:\n",
    "\n",
    "            raise ValueError('Not Cyrillic')\n",
    "        \n",
    "        answer.append(ans)\n",
    "\n",
    "        if j_:\n",
    "            if special:\n",
    "                answer.append('ṷ')\n",
    "                special = False\n",
    "            else:\n",
    "                answer.append('j')\n",
    "            j_ = False\n",
    "            \n",
    "\n",
    "    if separate == False:\n",
    "        return ''.join(answer[::-1])\n",
    "    return answer[::-1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "НОВЫЙ КОД"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 517,
   "metadata": {},
   "outputs": [],
   "source": [
    "def change(word):\n",
    "    word = re.sub('(с|ст|сс|з|зд|ж|ш)ч', 'щ', word)\n",
    "    word = re.sub('(с|зд|з)щ', 'щ', word)\n",
    "    word = re.sub('(тч|тш|дш)', 'ч', word)\n",
    "    word = re.sub('(с|з)ш', 'ш', word)\n",
    "    word = re.sub('сж', 'ж', word)\n",
    "    word = re.sub('(т|ть|д)с', 'ц', word)\n",
    "    word = re.sub('(ст|сть)с', 'ц', word)\n",
    "    return word"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 406,
   "metadata": {},
   "outputs": [],
   "source": [
    "def my_type(letter):\n",
    "    \n",
    "    if letter in vows.index:\n",
    "        return 'v'\n",
    "    \n",
    "    if letter in cons.index:\n",
    "        return 'c'\n",
    "    \n",
    "    if letter in ('ь', 'ъ'):\n",
    "        return 'm'\n",
    "    \n",
    "    else:\n",
    "        raise ValueError('Not Cyrillic')\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def vows_after_aff(ans2, index, answer):\n",
    "    \n",
    "    if data[ans2]['back'] == '+' and index > 0:\n",
    "        if answer[-1] == 'е':\n",
    "            answer[-1] = 'э'\n",
    "        if answer[-1] == 'и':\n",
    "            answer[-1] = 'ы'\n",
    "        if answer[-1] == 'ь':\n",
    "            answer[-1] = 'ъ'\n",
    "\n",
    "    elif data[ans2]['back'] == '-' and index > 0:\n",
    "        if answer[-1] == 'э':\n",
    "            answer[-1] = 'е'\n",
    "        if answer[-1] == 'ы':\n",
    "            answer[-1] = 'и'\n",
    "        if answer[-1] == 'ъ':\n",
    "            answer[-1] = 'ь'\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 548,
   "metadata": {},
   "outputs": [],
   "source": [
    "def due_to_vow_table(ans, index, letter, stress, vow_n, length):\n",
    "    \n",
    "    if vow_n == stress: # ударный \n",
    "     \n",
    "        if ans.value not in ('а', 'о', 'у', 'ы') and ans.next is not None and ans.next.type == 'c':\n",
    "            \n",
    "            if ans.value != 'э' and ans.next.value not in ('ш', 'ж', 'ц'):\n",
    "                ans.next.soft = True\n",
    "            elif ans.value in ('э', 'е') and ans.next.value in ('ш', 'ж', 'ц'):\n",
    "                letter = 'э'\n",
    "            elif ans.value == 'и':\n",
    "                letter = 'ы'\n",
    "                \n",
    "        j(ans, letter, length, index, 'V')\n",
    "        \n",
    "    elif index == length - 1:  # начало\n",
    "        j(ans, letter, length, index, '#')\n",
    "        \n",
    "        \n",
    "    elif vow_n == stress + 1: # первый предударный\n",
    "\n",
    "        if ans.next is not None and ans.next.value in ('ц', 'ж', 'ш'):\n",
    "            ans.value = vows.loc[letter]['v1_sh']\n",
    "        \n",
    "        elif letter in ('е', 'ё', 'и', 'ю', 'я'):\n",
    "            ans.value = vows.loc[letter]['v1_soft']\n",
    "            ans.next.soft = True\n",
    "        else:\n",
    "            ans.value = vows.loc[letter]['v1_hard']\n",
    "            \n",
    "            \n",
    "    elif vow_n >= stress + 2: # второй предударный\n",
    "        \n",
    "        if ans.next is not None and ans.next.value in ('ц', 'ж', 'ш'):\n",
    "            ans.value = vows.loc[letter]['v2_hard']\n",
    "        \n",
    "        elif ans.next is not None and ans.next.type == 'v':\n",
    "            if letter in ('е', 'ё', 'и', 'ю', 'я'):\n",
    "                ans.value = vows.loc[letter]['v1_soft']      \n",
    "            else:\n",
    "                ans.value = vows.loc[letter]['v1_hard']\n",
    "                \n",
    "        elif letter in ('е', 'ё', 'и', 'ю', 'я'):\n",
    "            ans.value = vows.loc[letter]['v2_soft']\n",
    "            ans.next.soft = True\n",
    "        else:\n",
    "            ans.value = vows.loc[letter]['v2_hard']\n",
    "            \n",
    "            \n",
    "    elif vow_n < stress: # заударные \n",
    "        \n",
    "        if ans.next is not None and ans.next.value in ('ц', 'ж', 'ш'):\n",
    "   \n",
    "            j(ans, letter, length, index, 'vn_hard')\n",
    "   \n",
    "        elif letter in ('е', 'ё', 'и', 'ю', 'я'):\n",
    "            \n",
    "            if vow_n == stress - 1 and ans.next is not None and ans.next.type == 'v':\n",
    "                j(ans, letter, length, index, 'vn_soft')\n",
    "            else:\n",
    "                ans.value = vows.loc[letter]['vn_soft']\n",
    "            ans.next.soft = True\n",
    "\n",
    "        else:\n",
    "            if vow_n == stress - 1 and ans.next is not None and ans.next.type == 'v':\n",
    "                j(ans, letter, length, index, 'vn_hard')\n",
    "            else:\n",
    "                ans.value = vows.loc[letter]['vn_hard']   \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 549,
   "metadata": {},
   "outputs": [],
   "source": [
    "def j(ans, letter, length, index, position):\n",
    "\n",
    "    ans.value = vows.loc[letter][position]\n",
    "\n",
    "    if letter in ('ю', 'е', 'ё', 'я'):\n",
    "        \n",
    "        if index == length - 1:\n",
    "            ans.j_ = True\n",
    "\n",
    "        elif ans.next is not None and ans.next.type == 'v':\n",
    "            ans.j_ = True\n",
    "     \n",
    "            if 'vn' in position:\n",
    "                ans.value = vows.loc[letter]['vn_hard']\n",
    "\n",
    "        elif ans.next is not None and ans.next.value in ('ь', 'ъ'):\n",
    "            ans.j_ = True\n",
    "\n",
    "            if 'vn' in position:\n",
    "                ans.value = vows.loc[letter]['vn_hard']\n",
    "\n",
    "    elif letter in ('и', 'о') and ans.next is not None and ans.next.value == 'ь':\n",
    "        ans.j_ = True\n",
    "\n",
    "        if 'vn' in position:\n",
    "                ans.value = vows.loc[letter]['vn_hard']\n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 616,
   "metadata": {},
   "outputs": [],
   "source": [
    "def cons_tranformer(ans, letter, vcd=False):\n",
    "    \n",
    "    a = letter\n",
    "\n",
    "    if letter in ('ч', 'ш', 'щ', 'ж'):\n",
    "        ans.value = cons.loc[ans.value]['hard']\n",
    "        if ans.__dict__.__contains__('soft'):\n",
    "            del ans.soft\n",
    "        if letter in ('ч', 'щ'):\n",
    "            if ans.__dict__.__contains__('no_voice'):\n",
    "                del ans.no_voice\n",
    "            if ans.__dict__.__contains__('voice'):\n",
    "                del ans.voice\n",
    "\n",
    "    if ans.__dict__.__contains__('no_voice'):  # оглушение\n",
    "        ans.value = cons.loc[ans.value]['no_voice']\n",
    "\n",
    "    elif ans.__dict__.__contains__('voice'):  # озвончение\n",
    "        ans.value = cons.loc[ans.value]['voiced']\n",
    "\n",
    "    if vcd is True:\n",
    "        if ans.previous is None:\n",
    "            ans.value = cons.loc[ans.value]['voiced']\n",
    "\n",
    "    if not vcd:\n",
    "        if ans.previous is None:  # конец слова\n",
    "            if ans.next is not None:\n",
    "                ans.next.no_voice = True\n",
    "            if data[ans.value]['vcd'] == '+':\n",
    "                ans.value = cons.loc[ans.value]['no_voice']\n",
    "    \n",
    "    if ans.next is not None:\n",
    "        if ans.value in data.columns and data[ans.value]['vcd'] == '-' and ans.next is not None:  # оглушение следующих\n",
    "\n",
    "            if ans.next.value in data.columns and data[ans.next.value]['son'] == '-':\n",
    "                ans.next.no_voice = True\n",
    "    \n",
    "        elif ans.value in data.columns and data[ans.value]['son'] == '-' and ans.value not in ('в', \"в’\") and data[ans.value]['vcd'] == '+':  # озвончение слудующих\n",
    "            ans.next.voice = True\n",
    "\n",
    "    if ans.previous is not None:\n",
    "\n",
    "        if ans.previous.value == 'к' and letter == 'г':\n",
    "            ans.value = 'х'\n",
    "        \n",
    "        elif ans.previous.value == 'т' and ans.value == \"ч’\":\n",
    "            ans.value = 'ш'\n",
    "\n",
    "        elif ans.previous.value in (ans.value, ans.value + \"’\"):\n",
    "            ans.value = ''\n",
    "\n",
    "    if ans.__dict__.__contains__('soft'):  # смягчение\n",
    "        ans.value = cons.loc[ans.value]['soft']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 558,
   "metadata": {},
   "outputs": [],
   "source": [
    "class Node(object):\n",
    "    def __init__(self, value=''):\n",
    "        self.value = value\n",
    "        self.type = None\n",
    "        self.previous = None\n",
    "        self.next = None\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 601,
   "metadata": {},
   "outputs": [],
   "source": [
    "def transcription(word, stress=False, next_word=False, separate=True, stop=False, vcd=False):\n",
    "    \"\"\"\n",
    "    Фунция, которая определяет фонетическую транскриацию для слова с заданным ударением,\n",
    "    расчитываемым с конца слова. \n",
    "    \n",
    "    Функция принимает 3 аргемента: \n",
    "    i - type int, номер гласного, на который падает ударение (отсчет производится с конца слова).\n",
    "    word - type str, слово, для которого должен произвожится разбор. \n",
    "    \n",
    "    >>> transcription(2, 'мама')\n",
    "    ['м', 'а', 'м', 'ъ']\n",
    "    \n",
    "    >>> transcription(1, 'мама')\n",
    "    ['м', 'а', 'м', 'а']\n",
    "    \n",
    "    \n",
    "    Функция работает только с кириллическими символами. Если в слове содержатся не кириллические символы, вызывается ошибка.\n",
    "    \n",
    "    >>> transcription(2, 'papa')\n",
    "    Traceback (most recent call last):\n",
    "        ...\n",
    "    ValueError: No vowles or not Cyrillic elements\n",
    "    \n",
    "    \n",
    "    Если пользователь указывает номер гласной меньший кол-ва гласных, вызывается ошибка.\n",
    "    \n",
    "    >>> transcription(3, 'мама')\n",
    "    Traceback (most recent call last):\n",
    "        ...\n",
    "    ValueError: There are only 2 vowel(s)\n",
    "    \"\"\"\n",
    "   \n",
    "    if not isinstance(word, str):\n",
    "        raise ValueError('Wrong data type')\n",
    "        \n",
    "    if not isinstance(stress, int):\n",
    "        raise ValueError('Wrong data type')\n",
    "        \n",
    "    if ' ' in word:\n",
    "        raise ValueError('Enter a word, not a phrase')\n",
    "        \n",
    "    nums = num_of_vowls(word)\n",
    "\n",
    "    if stress:\n",
    "        if nums < stress or stress <= 0:\n",
    "            raise ValueError('There are only {} vowel(s)'.format(str(num_of_vowls(word))))\n",
    "        \n",
    "    if not stress:\n",
    "        stress = nums//2 + 1\n",
    "    \n",
    "    if stop == True:\n",
    "        stress = -100000\n",
    "\n",
    "    letters = list(change(word))[::-1]\n",
    "    \n",
    "    ans = Node()\n",
    "    head = ans \n",
    "    prev = ans\n",
    "    answer = []\n",
    "    special = False\n",
    "    \n",
    "    length = len(letters)\n",
    "    vow_n = 0\n",
    "        \n",
    "    for index, letter in enumerate(letters):\n",
    "\n",
    "        letter = letter.lower()\n",
    "        \n",
    "        if index == 0:\n",
    "            ans.value = letter\n",
    "            ans.type = my_type(letter)\n",
    "            head = ans\n",
    "        else:\n",
    "            ans.previous = prev\n",
    "        \n",
    "        if index != length - 1: # если не начало слова\n",
    "            ans.next = Node(letters[index+1])\n",
    "            ans.next.type = my_type(ans.next.value)\n",
    "            \n",
    "        if ans.type == 'v':  # гласные\n",
    "            vow_n += 1\n",
    "            due_to_vow_table(ans, index, letter, stress, vow_n, length)\n",
    "            if ans.__dict__.__contains__('j_') and index == 0 and vow_n != stress:\n",
    "                special = True\n",
    "        \n",
    "        elif ans.type == 'm':  # знаки\n",
    "\n",
    "            if letter == 'ь':\n",
    "                ans.next.soft = True\n",
    "            ans.value = ''\n",
    "\n",
    "        elif ans.type == 'c':  # согласные\n",
    "\n",
    "            if letter == 'й':\n",
    "                ans.value = 'ṷ'\n",
    "            else:\n",
    "                cons_tranformer(ans, letter)\n",
    "        \n",
    "        else:\n",
    "            raise ValueError('Not Cyrillic')\n",
    "\n",
    "        if ans.value == '' and index != 0:\n",
    "            prev = ans.previous\n",
    "        else:\n",
    "            answer.append(ans.value)\n",
    "            prev = ans\n",
    "        \n",
    "        if ans.__dict__.__contains__('j_'):\n",
    "            if special:\n",
    "                answer.append('ṷ')\n",
    "                special = False\n",
    "            else:\n",
    "                answer.append('j')\n",
    "        \n",
    "        ans = ans.next\n",
    "    \n",
    "    if separate == False:\n",
    "        return ''.join(answer[::-1])\n",
    "    return answer[::-1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 603,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "пат’ашк’ь\n",
      "--- 0.0024590492248535156 seconds ---\n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "start_time = time.time()\n",
    "print(transcription2('подтяжки', stress=2, separate=False))\n",
    "print(\"--- %s seconds ---\" % (time.time() - start_time))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Результат новой версии"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 618,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "пат’ашк’ь\n",
      "--- 0.0017690658569335938 seconds ---\n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "start_time = time.time()\n",
    "print(transcription('подтяжки', stress=2, separate=False))\n",
    "print(\"--- %s seconds ---\" % (time.time() - start_time))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 611,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'т'"
      ]
     },
     "execution_count": 611,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcription('дт', stress=1, separate=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 612,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'дрожъ'"
      ]
     },
     "execution_count": 612,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcription('дрожжи', stress=2, separate=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "stop_words = ['а',  'без',  'близ',  'в',  'вне',  'во',  'вокруг',  'вслед',  'для',  'до',  'за',  'и',  'из', \n",
    "              'изза',  'изо',  'изпод',  'к',  'ко',  'меж',  'между',  'мимо',  'на',  'над',  'о',  'об',  'обо', \n",
    "              'около',  'от',  'ото',  'перед',  'передо',  'по', 'поверх',  'под',  'подо',  'понад',  'после', \n",
    "              'пред',  'при',  'про',  'ради',  'с',  'сверх',  'сверху']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "def tokenize(text):\n",
    "    text = re.sub(r'[^\\w\\s]','',text).replace('\\n', '')\n",
    "    text = re.sub(r'[\\s]{2,}',' ',text)\n",
    "    return text.split(' ')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "def phrase_transformer(text, separate=True):\n",
    "    \n",
    "    def combine(terms, accum):\n",
    "\n",
    "        last = (len(terms) == 1)\n",
    "        n = len(terms[0])\n",
    "\n",
    "        for i in range(n):\n",
    "            item = accum + [terms[0][i]]\n",
    "\n",
    "            if last:\n",
    "                combinations.append(item)\n",
    "            else:\n",
    "                combine(terms[1:], item)\n",
    "                \n",
    "    if not isinstance(text, str):\n",
    "        raise ValueError('Wrong data type')\n",
    "\n",
    "    num_words = 0\n",
    "    words = tokenize(text)\n",
    "    answer = []\n",
    "    combinations = []\n",
    "    length = len(words)\n",
    "\n",
    "    for index, word in enumerate(words):\n",
    "\n",
    "        stop = False\n",
    "        vcd = False  # озвончение, если это фраза \n",
    "   \n",
    "        if word in stop_words and length > 1:\n",
    "\n",
    "            stop = True\n",
    "            if index+1 <= len(words)-1 and words[index+1][0] in data.columns and data[words[index+1][0]]['vcd'] == '+':\n",
    "                vcd = True\n",
    "        \n",
    "        answer.append([])\n",
    "        \n",
    "        for stress in stressed(word, st_words):\n",
    "            num_words+=1\n",
    "            if separate == False:\n",
    "             \n",
    "                answer[-1].append(''.join(transcription(word, stop=stop, vcd=vcd, stress=stress)))\n",
    "\n",
    "            else:\n",
    "                answer[-1].append(transcription(word, stop=stop, vcd=vcd, stress=stress))\n",
    "\n",
    "    combine(answer, [])\n",
    "    return combinations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[['з', 'а', 'м', 'ъ', 'к']]\n",
      "[['з', 'а', 'м', 'о', 'к']]\n"
     ]
    }
   ],
   "source": [
    "a = phrase_transformer('замок')\n",
    "for i in a:\n",
    "    print(i)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[[['к', 'о', 'т’', 'ь', 'к']]]"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "phrase_transformer('котик')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[['вол’ь']]"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "phrase_transformer('воля', separate=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "def phonetic_distance(word1, word2=False, transcription=False):\n",
    "    \n",
    "    word1 = phrase_transformer(word1)\n",
    "        \n",
    "    if len(word1[0]) > 1:\n",
    "        raise ValueError('Enter values must be words, not phrases')\n",
    "            \n",
    "    word2 = phrase_transformer(word2)\n",
    "        \n",
    "    if len(word1[0]) > 1:\n",
    "        raise ValueError('Enter values must be words, not phrases')\n",
    "\n",
    "    answer = []\n",
    "        \n",
    "    for w1 in word1:\n",
    "        for w2 in word2:\n",
    "\n",
    "            if transcription:\n",
    "                answer.append([''.join(w1[0]), ''.join(w2[0]), lev_distance(w1[0], w2[0])])\n",
    "            else:\n",
    "                answer.append(lev_distance(w1[0], w2[0]))\n",
    "        \n",
    "    return answer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 219,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['м', 'а', 'с', 'к']"
      ]
     },
     "execution_count": 219,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcription('мозг')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[3.0, 2.475]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "phonetic_distance('замок', 'заминка')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "господи\n",
    "ага\n",
    "бога\n",
    "бугалтер"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Добавить ситуацию со стоп словом, когда он "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Тестирую, если ли хорошо ставить ударение на 1 слог"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {},
   "outputs": [],
   "source": [
    "import random\n",
    "from sklearn.metrics import accuracy_score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {},
   "outputs": [],
   "source": [
    "a = random.sample(st_words.index.tolist(), 1500)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_real = [] # реальное ударение\n",
    "y_pred_first = [] # на первый слог\n",
    "y_pred_last = []  # на последний слог\n",
    "y_pred_random = [] # на рандомный\n",
    "y_pred_mid = [] # на срединный \n",
    "y_pred_1 = []\n",
    "\n",
    "for i in a:\n",
    "    b = st_words.loc[i]['stressed_s']\n",
    "    n = num_of_vowls(i)\n",
    "    if not type(b) == pd.core.series.Series:\n",
    "        y_real.append(b)\n",
    "        y_pred_first.append(n)\n",
    "        y_pred_last.append(1)\n",
    "        y_pred_random.append(random.randint(1, n))\n",
    "        y_pred_mid.append(n//2)\n",
    "        y_pred_1.append(n//2 + 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.1108843537414966"
      ]
     },
     "execution_count": 135,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_real, y_pred_first)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.05510204081632653"
      ]
     },
     "execution_count": 136,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_real, y_pred_last)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.20612244897959184"
      ]
     },
     "execution_count": 137,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_real, y_pred_random)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.24557823129251702"
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_real, y_pred_mid)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.42108843537414964"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_real, y_pred_1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'прощет'"
      ]
     },
     "execution_count": 166,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a = 'просчет'\n",
    "re.sub('(сс|с|ст|з|зд)ч', 'щ', a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "a = 'дрожжи'\n",
    "re.sub('(сс|с|ст|з|зд)ж', 'щ', a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "СТАРЫЕ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
